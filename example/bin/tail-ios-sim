#!/usr/bin/python

# Find the latest iOS simulator log and tail it.

import os, sys, time

def find_log():
    d = os.path.expanduser("~/Library/Logs/CoreSimulator")

    subdirs = [os.path.join(d, f) for f in os.listdir(d) if os.path.isdir(os.path.join(d, f))]

    assert subdirs, "Could not find log directory"

    newest = None
    log_fn = None

    for s in subdirs:
        fn = os.path.join(s, "system.log")
        try:
            mtime = time.ctime(os.path.getmtime(fn))
        except OSError:
            continue

        if not newest or mtime < newest:
            log_fn = fn
            newest = mtime

    assert log_fn, "Could not find system.log"

    os.execvp("tail", ["tail", "-n", "50", "-f", log_fn])

find_log()
